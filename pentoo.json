{
	"builders": [{
		"name" : "pentoo-vbox-bios",
		"type": "virtualbox-iso",
		"guest_os_type": "Gentoo_64",
		"hard_drive_interface": "sata",
		"iso_url": "http://mirror.switch.ch/ftp/mirror/pentoo/Pentoo_amd64_hardened/pentoo-amd64-hardened-2018.0_RC8.iso",
		"iso_checksum": "3b2c971fadc2c7155ee06d236820481eeb8b76926f2488a33ca9e3adc0989e4149e1e30e14f76309070cc7d8ebdbc5e9696270493deb8976fceccb81ed50c475",
		"iso_checksum_type": "sha512",
		"ssh_username": "pentoo",
		"ssh_password": "pentoo",
		"ssh_pty" : "true",
		"shutdown_command": "echo 'pentoo' | sudo -S shutdown -P now",
		"vboxmanage": [
			["modifyvm", "{{.Name}}", "--firmware", "bios"],
			["modifyvm", "{{.Name}}", "--memory", "4096"],
			["modifyvm", "{{.Name}}", "--cpus", "2"]
		],
		"boot_wait" : "2m0s",
		"boot_command" : [
			"pentoo<enter><wait>pentoo<enter><wait>",
			"sudo rc-service sshd start<enter><wait>",
			"sudo rc-service NetworkManager start<enter><wait>"
		],
		"disk_size" : "65536",
		"headless" : false
	},{
		"name" : "pentoo-vbox-bios-minimal",
		"type": "virtualbox-iso",
		"guest_os_type": "Gentoo_64",
		"hard_drive_interface": "sata",
		"iso_url": "http://mirror.switch.ch/ftp/mirror/pentoo/Pentoo_amd64_hardened/pentoo-amd64-hardened-2018.0_RC8.iso",
		"iso_checksum": "3b2c971fadc2c7155ee06d236820481eeb8b76926f2488a33ca9e3adc0989e4149e1e30e14f76309070cc7d8ebdbc5e9696270493deb8976fceccb81ed50c475",
		"iso_checksum_type": "sha512",
		"ssh_username": "pentoo",
		"ssh_password": "pentoo",
		"ssh_pty" : "true",
		"shutdown_command": "echo 'pentoo' | sudo -S shutdown -P now",
		"vboxmanage": [
			["modifyvm", "{{.Name}}", "--firmware", "bios"],
			["modifyvm", "{{.Name}}", "--memory", "1024"],
			["modifyvm", "{{.Name}}", "--cpus", "1"]
		],
		"boot_wait" : "2m0s",
		"boot_command" : [
			"pentoo<enter><wait>pentoo<enter><wait>",
			"sudo rc-service sshd start<enter><wait>",
			"sudo rc-service NetworkManager start<enter><wait>"
		],
		"disk_size" : "65536",
		"headless" : false
	}],
	"provisioners": [{
		"type": "shell",
		"inline": [
			"mkdir -p ~/.ssh",
			"curl -sS https://raw.githubusercontent.com/hashicorp/vagrant/master/keys/vagrant.pub >> ~/.ssh/authorized_keys",
			"chmod 0600 ~/.ssh/authorized_keys",
			"sudo rc-update add NetworkManager default",
			"sudo rc-update add sshd default",
			"echo 'GENTOO_MIRRORS=\"http://mirror.switch.ch/ftp/mirror/gentoo/ ftp://mirror.switch.ch/mirror/gentoo/\"' | sudo tee --append /etc/portage/make.conf",
			"sudo emerge -1 --update layman",
			"sudo layman -f",
			"yes | sudo layman -a wuodan",
			"sudo ACCEPT_KEYWORDS='~amd64' USE=doc emerge -1 '=pentoo/pentoo-installer-20180805'",
			"sudo layman -d wuodan",
			"xzcat /usr/share/doc/pentoo-installer-20180805/config-samples/config.bios.msdos.json.xz > /tmp/config.bios.msdos.json",
			"sudo pentoo-installer --headless --config-file /tmp/config.bios.msdos.json",
			"cat /tmp/pentoo-installer.log"
		]
	}],
	"post-processors": ["vagrant"]
}
